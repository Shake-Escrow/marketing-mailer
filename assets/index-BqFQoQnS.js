import{r as Ae,a as Te,u as De,b as Ne,d as ne,P as Pe,M as Me}from"./msal-FckaZgfA.js";import{r as Fe}from"./vendor-TrU4HtWd.js";import{r as Ue}from"./mammoth-DLirEAGF.js";(function(){const g=document.createElement("link").relList;if(g&&g.supports&&g.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))i(u);new MutationObserver(u=>{for(const _ of u)if(_.type==="childList")for(const h of _.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function w(u){const _={};return u.integrity&&(_.integrity=u.integrity),u.referrerPolicy&&(_.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?_.credentials="include":u.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function i(u){if(u.ep)return;u.ep=!0;const _=w(u);fetch(u.href,_)}})();var ve={exports:{}},ge={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Se;function qe(){if(Se)return ge;Se=1;var m=Ae(),g=Symbol.for("react.element"),w=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,u=m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_={key:!0,ref:!0,__self:!0,__source:!0};function h(A,R,n){var E,L={},b=null,F=null;n!==void 0&&(b=""+n),R.key!==void 0&&(b=""+R.key),R.ref!==void 0&&(F=R.ref);for(E in R)i.call(R,E)&&!_.hasOwnProperty(E)&&(L[E]=R[E]);if(A&&A.defaultProps)for(E in R=A.defaultProps,R)L[E]===void 0&&(L[E]=R[E]);return{$$typeof:g,type:A,key:b,ref:F,props:L,_owner:u.current}}return ge.Fragment=w,ge.jsx=h,ge.jsxs=h,ge}var Ee;function ze(){return Ee||(Ee=1,ve.exports=qe()),ve.exports}var o=ze(),ye={},je;function $e(){if(je)return ye;je=1;var m=Fe();return ye.createRoot=m.createRoot,ye.hydrateRoot=m.hydrateRoot,ye}var Be=$e();const He={auth:{clientId:"0b4519f6-3e5a-4bc7-927c-219b9104825b",authority:"https://login.microsoftonline.com/76ef6c29-fcf7-4941-9312-3a70fb1abd8b",redirectUri:window.location.origin},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1}},Re={scopes:["Mail.Send","User.Read"]};var We=Ue();const Ke=Te(We);async function Je(m){const g=await m.arrayBuffer(),w=await Ke.convertToHtml({arrayBuffer:g}),i=w.value,u=w.messages,_=document.createElement("div");_.innerHTML=i;let h="";const A=Array.from(_.children),R=b=>b.textContent.trim()==="";let n=A.findIndex(b=>!R(b));if(n!==-1){const b=A[n],F=b.textContent.trim(),te=F.match(/^subject\s*:\s*(.+)$/i);if(te)h=te[1].trim(),b.remove();else{const G=A.slice(n+1).findIndex(K=>!R(K)),X=G!==-1?A.slice(n+1)[G]:null;X&&/^dear\s/i.test(X.textContent.trim())?(h=F,b.remove()):b.tagName==="H1"?h=F:h=F.substring(0,80)}}Ve(_);const E=_.innerHTML,L=_.textContent.replace(/\s+/g," ").trim();return{html:E,text:L,subject:h,warnings:u.filter(b=>b.type==="warning").map(b=>b.message)}}function Ve(m){const g=document.createTreeWalker(m,NodeFilter.SHOW_TEXT),w=[];let i;for(;i=g.nextNode();)w.push(i);for(const u of w)u.nodeValue=u.nodeValue.replace(/\bDear\s+(?!{{name}})([^,:\n]+)[,:]?/gi,(_,h,A,R)=>{const n=_.trim(),E=n.endsWith(","),L=n.endsWith(":");return"Dear {{name}},"})}function xe(m,g){return m.replace(/\{\{(\s*[\w.-]+\s*)\}\}/g,(w,i)=>{const u=i.trim().toLowerCase();return g[u]!==void 0?g[u]:w})}var be={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var Qe=be.exports,Oe;function Xe(){return Oe||(Oe=1,(function(m,g){((w,i)=>{m.exports=i()})(Qe,function w(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},u,_=!i.document&&!!i.postMessage,h=i.IS_PAPA_WORKER||!1,A={},R=0,n={};function E(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var r=de(t);r.chunkSize=parseInt(r.chunkSize),t.step||t.chunk||(r.chunkSize=null),this._handle=new G(r),(this._handle.streamer=this)._config=r}).call(this,e),this.parseChunk=function(t,r){var a=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<a){let y=this._config.newline;y||(s=this._config.quoteChar||'"',y=this._handle.guessLineEndings(t,s)),t=[...t.split(y).slice(a)].join(y)}this.isFirstChunk&&j(this._config.beforeFirstChunk)&&(s=this._config.beforeFirstChunk(t))!==void 0&&(t=s),this.isFirstChunk=!1,this._halted=!1;var a=this._partialLine+t,s=(this._partialLine="",this._handle.parse(a,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=s.meta.cursor,a=(this._finished||(this._partialLine=a.substring(t-this._baseIndex),this._baseIndex=t),s&&s.data&&(this._rowCount+=s.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),h)i.postMessage({results:s,workerId:n.WORKER_ID,finished:a});else if(j(this._config.chunk)&&!r){if(this._config.chunk(s,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=s=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(s.data),this._completeResults.errors=this._completeResults.errors.concat(s.errors),this._completeResults.meta=s.meta),this._completed||!a||!j(this._config.complete)||s&&s.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),a||s&&s.meta.paused||this._nextChunk(),s}this._halted=!0},this._sendError=function(t){j(this._config.error)?this._config.error(t):h&&this._config.error&&i.postMessage({workerId:n.WORKER_ID,error:t,finished:!1})}}function L(e){var t;(e=e||{}).chunkSize||(e.chunkSize=n.RemoteChunkSize),E.call(this,e),this._nextChunk=_?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(r){this._input=r,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),_||(t.onload=se(this._chunkLoaded,this),t.onerror=se(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!_),this._config.downloadRequestHeaders){var r,a=this._config.downloadRequestHeaders;for(r in a)t.setRequestHeader(r,a[r])}var s;this._config.chunkSize&&(s=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+s));try{t.send(this._config.downloadRequestBody)}catch(y){this._chunkError(y.message)}_&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(r=>(r=r.getResponseHeader("Content-Range"))!==null?parseInt(r.substring(r.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(r){r=t.statusText||r,this._sendError(new Error(r))}}function b(e){(e=e||{}).chunkSize||(e.chunkSize=n.LocalChunkSize),E.call(this,e);var t,r,a=typeof FileReader<"u";this.stream=function(s){this._input=s,r=s.slice||s.webkitSlice||s.mozSlice,a?((t=new FileReader).onload=se(this._chunkLoaded,this),t.onerror=se(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var s=this._input,y=(this._config.chunkSize&&(y=Math.min(this._start+this._config.chunkSize,this._input.size),s=r.call(s,this._start,y)),t.readAsText(s,this._config.encoding));a||this._chunkLoaded({target:{result:y}})},this._chunkLoaded=function(s){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(s.target.result)},this._chunkError=function(){this._sendError(t.error)}}function F(e){var t;E.call(this,e=e||{}),this.stream=function(r){return t=r,this._nextChunk()},this._nextChunk=function(){var r,a;if(!this._finished)return r=this._config.chunkSize,t=r?(a=t.substring(0,r),t.substring(r)):(a=t,""),this._finished=!t,this.parseChunk(a)}}function te(e){E.call(this,e=e||{});var t=[],r=!0,a=!1;this.pause=function(){E.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){E.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(s){this._input=s,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){a&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):r=!0},this._streamData=se(function(s){try{t.push(typeof s=="string"?s:s.toString(this._config.encoding)),r&&(r=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(y){this._streamError(y)}},this),this._streamError=se(function(s){this._streamCleanUp(),this._sendError(s)},this),this._streamEnd=se(function(){this._streamCleanUp(),a=!0,this._streamData("")},this),this._streamCleanUp=se(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function G(e){var t,r,a,s,y=Math.pow(2,53),q=-y,O=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,T=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,d=this,v=0,f=0,H=!1,l=!1,k=[],c={data:[],errors:[],meta:{}};function D(C){return e.skipEmptyLines==="greedy"?C.join("").trim()==="":C.length===1&&C[0].length===0}function M(){if(c&&a&&(ee("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+n.DefaultDelimiter+"'"),a=!1),e.skipEmptyLines&&(c.data=c.data.filter(function(p){return!D(p)})),J()){let p=function($,B){j(e.transformHeader)&&($=e.transformHeader($,B)),k.push($)};if(c)if(Array.isArray(c.data[0])){for(var C=0;J()&&C<c.data.length;C++)c.data[C].forEach(p);c.data.splice(0,1)}else c.data.forEach(p)}function I(p,$){for(var B=e.header?{}:[],N=0;N<p.length;N++){var P=N,S=p[N],S=((re,x)=>(U=>(e.dynamicTypingFunction&&e.dynamicTyping[U]===void 0&&(e.dynamicTyping[U]=e.dynamicTypingFunction(U)),(e.dynamicTyping[U]||e.dynamicTyping)===!0))(re)?x==="true"||x==="TRUE"||x!=="false"&&x!=="FALSE"&&((U=>{if(O.test(U)&&(U=parseFloat(U),q<U&&U<y))return 1})(x)?parseFloat(x):T.test(x)?new Date(x):x===""?null:x):x)(P=e.header?N>=k.length?"__parsed_extra":k[N]:P,S=e.transform?e.transform(S,P):S);P==="__parsed_extra"?(B[P]=B[P]||[],B[P].push(S)):B[P]=S}return e.header&&(N>k.length?ee("FieldMismatch","TooManyFields","Too many fields: expected "+k.length+" fields but parsed "+N,f+$):N<k.length&&ee("FieldMismatch","TooFewFields","Too few fields: expected "+k.length+" fields but parsed "+N,f+$)),B}var z;c&&(e.header||e.dynamicTyping||e.transform)&&(z=1,!c.data.length||Array.isArray(c.data[0])?(c.data=c.data.map(I),z=c.data.length):c.data=I(c.data,0),e.header&&c.meta&&(c.meta.fields=k),f+=z)}function J(){return e.header&&k.length===0}function ee(C,I,z,p){C={type:C,code:I,message:z},p!==void 0&&(C.row=p),c.errors.push(C)}j(e.step)&&(s=e.step,e.step=function(C){c=C,J()?M():(M(),c.data.length!==0&&(v+=C.data.length,e.preview&&v>e.preview?r.abort():(c.data=c.data[0],s(c,d))))}),this.parse=function(C,I,z){var p=e.quoteChar||'"',p=(e.newline||(e.newline=this.guessLineEndings(C,p)),a=!1,e.delimiter?j(e.delimiter)&&(e.delimiter=e.delimiter(C),c.meta.delimiter=e.delimiter):((p=(($,B,N,P,S)=>{var re,x,U,ue;S=S||[",","	","|",";",n.RECORD_SEP,n.UNIT_SEP];for(var he=0;he<S.length;he++){for(var ie,pe=S[he],V=0,ae=0,W=0,Y=(U=void 0,new K({comments:P,delimiter:pe,newline:B,preview:10}).parse($)),le=0;le<Y.data.length;le++)N&&D(Y.data[le])?W++:(ie=Y.data[le].length,ae+=ie,U===void 0?U=ie:0<ie&&(V+=Math.abs(ie-U),U=ie));0<Y.data.length&&(ae/=Y.data.length-W),(x===void 0||V<=x)&&(ue===void 0||ue<ae)&&1.99<ae&&(x=V,re=pe,ue=ae)}return{successful:!!(e.delimiter=re),bestDelimiter:re}})(C,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=p.bestDelimiter:(a=!0,e.delimiter=n.DefaultDelimiter),c.meta.delimiter=e.delimiter),de(e));return e.preview&&e.header&&p.preview++,t=C,r=new K(p),c=r.parse(t,I,z),M(),H?{meta:{paused:!0}}:c||{meta:{paused:!1}}},this.paused=function(){return H},this.pause=function(){H=!0,r.abort(),t=j(e.chunk)?"":t.substring(r.getCharIndex())},this.resume=function(){d.streamer._halted?(H=!1,d.streamer.parseChunk(t,!0)):setTimeout(d.resume,3)},this.aborted=function(){return l},this.abort=function(){l=!0,r.abort(),c.meta.aborted=!0,j(e.complete)&&e.complete(c),t=""},this.guessLineEndings=function($,p){$=$.substring(0,1048576);var p=new RegExp(X(p)+"([^]*?)"+X(p),"gm"),z=($=$.replace(p,"")).split("\r"),p=$.split(`
`),$=1<p.length&&p[0].length<z[0].length;if(z.length===1||$)return`
`;for(var B=0,N=0;N<z.length;N++)z[N][0]===`
`&&B++;return B>=z.length/2?`\r
`:"\r"}}function X(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function K(e){var t=(e=e||{}).delimiter,r=e.newline,a=e.comments,s=e.step,y=e.preview,q=e.fastMode,O=null,T=!1,d=e.quoteChar==null?'"':e.quoteChar,v=d;if(e.escapeChar!==void 0&&(v=e.escapeChar),(typeof t!="string"||-1<n.BAD_DELIMITERS.indexOf(t))&&(t=","),a===t)throw new Error("Comment character same as delimiter");a===!0?a="#":(typeof a!="string"||-1<n.BAD_DELIMITERS.indexOf(a))&&(a=!1),r!==`
`&&r!=="\r"&&r!==`\r
`&&(r=`
`);var f=0,H=!1;this.parse=function(l,k,c){if(typeof l!="string")throw new Error("Input must be a string");var D=l.length,M=t.length,J=r.length,ee=a.length,C=j(s),I=[],z=[],p=[],$=f=0;if(!l)return V();if(q||q!==!1&&l.indexOf(d)===-1){for(var B=l.split(r),N=0;N<B.length;N++){if(p=B[N],f+=p.length,N!==B.length-1)f+=r.length;else if(c)return V();if(!a||p.substring(0,ee)!==a){if(C){if(I=[],ue(p.split(t)),ae(),H)return V()}else ue(p.split(t));if(y&&y<=N)return I=I.slice(0,y),V(!0)}}return V()}for(var P=l.indexOf(t,f),S=l.indexOf(r,f),re=new RegExp(X(v)+X(d),"g"),x=l.indexOf(d,f);;)if(l[f]===d)for(x=f,f++;;){if((x=l.indexOf(d,x+1))===-1)return c||z.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:I.length,index:f}),ie();if(x===D-1)return ie(l.substring(f,x).replace(re,d));if(d===v&&l[x+1]===v)x++;else if(d===v||x===0||l[x-1]!==v){P!==-1&&P<x+1&&(P=l.indexOf(t,x+1));var U=he((S=S!==-1&&S<x+1?l.indexOf(r,x+1):S)===-1?P:Math.min(P,S));if(l.substr(x+1+U,M)===t){p.push(l.substring(f,x).replace(re,d)),l[f=x+1+U+M]!==d&&(x=l.indexOf(d,f)),P=l.indexOf(t,f),S=l.indexOf(r,f);break}if(U=he(S),l.substring(x+1+U,x+1+U+J)===r){if(p.push(l.substring(f,x).replace(re,d)),pe(x+1+U+J),P=l.indexOf(t,f),x=l.indexOf(d,f),C&&(ae(),H))return V();if(y&&I.length>=y)return V(!0);break}z.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:I.length,index:f}),x++}}else if(a&&p.length===0&&l.substring(f,f+ee)===a){if(S===-1)return V();f=S+J,S=l.indexOf(r,f),P=l.indexOf(t,f)}else if(P!==-1&&(P<S||S===-1))p.push(l.substring(f,P)),f=P+M,P=l.indexOf(t,f);else{if(S===-1)break;if(p.push(l.substring(f,S)),pe(S+J),C&&(ae(),H))return V();if(y&&I.length>=y)return V(!0)}return ie();function ue(W){I.push(W),$=f}function he(W){var Y=0;return Y=W!==-1&&(W=l.substring(x+1,W))&&W.trim()===""?W.length:Y}function ie(W){return c||(W===void 0&&(W=l.substring(f)),p.push(W),f=D,ue(p),C&&ae()),V()}function pe(W){f=W,ue(p),p=[],S=l.indexOf(r,f)}function V(W){if(e.header&&!k&&I.length&&!T){var Y=I[0],le=Object.create(null),ke=new Set(Y);let we=!1;for(let fe=0;fe<Y.length;fe++){let oe=Y[fe];if(le[oe=j(e.transformHeader)?e.transformHeader(oe,fe):oe]){let me,Ce=le[oe];for(;me=oe+"_"+Ce,Ce++,ke.has(me););ke.add(me),Y[fe]=me,le[oe]++,we=!0,(O=O===null?{}:O)[me]=oe}else le[oe]=1,Y[fe]=oe;ke.add(oe)}we&&console.warn("Duplicate headers found and renamed."),T=!0}return{data:I,errors:z,meta:{delimiter:t,linebreak:r,aborted:H,truncated:!!W,cursor:$+(k||0),renamedHeaders:O}}}function ae(){s(V()),I=[],z=[]}},this.abort=function(){H=!0},this.getCharIndex=function(){return f}}function Z(e){var t=e.data,r=A[t.workerId],a=!1;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var s={abort:function(){a=!0,Q(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:ce,resume:ce};if(j(r.userStep)){for(var y=0;y<t.results.data.length&&(r.userStep({data:t.results.data[y],errors:t.results.errors,meta:t.results.meta},s),!a);y++);delete t.results}else j(r.userChunk)&&(r.userChunk(t.results,s,t.file),delete t.results)}t.finished&&!a&&Q(t.workerId,t.results)}function Q(e,t){var r=A[e];j(r.userComplete)&&r.userComplete(t),r.terminate(),delete A[e]}function ce(){throw new Error("Not implemented.")}function de(e){if(typeof e!="object"||e===null)return e;var t,r=Array.isArray(e)?[]:{};for(t in e)r[t]=de(e[t]);return r}function se(e,t){return function(){e.apply(t,arguments)}}function j(e){return typeof e=="function"}return n.parse=function(e,t){var r=(t=t||{}).dynamicTyping||!1;if(j(r)&&(t.dynamicTypingFunction=r,r={}),t.dynamicTyping=r,t.transform=!!j(t.transform)&&t.transform,!t.worker||!n.WORKERS_SUPPORTED)return r=null,n.NODE_STREAM_INPUT,typeof e=="string"?(e=(a=>a.charCodeAt(0)!==65279?a:a.slice(1))(e),r=new(t.download?L:F)(t)):e.readable===!0&&j(e.read)&&j(e.on)?r=new te(t):(i.File&&e instanceof File||e instanceof Object)&&(r=new b(t)),r.stream(e);(r=(()=>{var a;return!!n.WORKERS_SUPPORTED&&(a=(()=>{var s=i.URL||i.webkitURL||null,y=w.toString();return n.BLOB_URL||(n.BLOB_URL=s.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",y,")();"],{type:"text/javascript"})))})(),(a=new i.Worker(a)).onmessage=Z,a.id=R++,A[a.id]=a)})()).userStep=t.step,r.userChunk=t.chunk,r.userComplete=t.complete,r.userError=t.error,t.step=j(t.step),t.chunk=j(t.chunk),t.complete=j(t.complete),t.error=j(t.error),delete t.worker,r.postMessage({input:e,config:t,workerId:r.id})},n.unparse=function(e,t){var r=!1,a=!0,s=",",y=`\r
`,q='"',O=q+q,T=!1,d=null,v=!1,f=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||n.BAD_DELIMITERS.filter(function(k){return t.delimiter.indexOf(k)!==-1}).length||(s=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(r=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(T=t.skipEmptyLines),typeof t.newline=="string"&&(y=t.newline),typeof t.quoteChar=="string"&&(q=t.quoteChar),typeof t.header=="boolean"&&(a=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");d=t.columns}t.escapeChar!==void 0&&(O=t.escapeChar+q),t.escapeFormulae instanceof RegExp?v=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(v=/^[=+\-@\t\r].*$/)}})(),new RegExp(X(q),"g"));if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return H(null,e,T);if(typeof e[0]=="object")return H(d||Object.keys(e[0]),e,T)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||d),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]=="object"?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||typeof e.data[0]=="object"||(e.data=[e.data])),H(e.fields||[],e.data||[],T);throw new Error("Unable to serialize unrecognized input");function H(k,c,D){var M="",J=(typeof k=="string"&&(k=JSON.parse(k)),typeof c=="string"&&(c=JSON.parse(c)),Array.isArray(k)&&0<k.length),ee=!Array.isArray(c[0]);if(J&&a){for(var C=0;C<k.length;C++)0<C&&(M+=s),M+=l(k[C],C);0<c.length&&(M+=y)}for(var I=0;I<c.length;I++){var z=(J?k:c[I]).length,p=!1,$=J?Object.keys(c[I]).length===0:c[I].length===0;if(D&&!J&&(p=D==="greedy"?c[I].join("").trim()==="":c[I].length===1&&c[I][0].length===0),D==="greedy"&&J){for(var B=[],N=0;N<z;N++){var P=ee?k[N]:N;B.push(c[I][P])}p=B.join("").trim()===""}if(!p){for(var S=0;S<z;S++){0<S&&!$&&(M+=s);var re=J&&ee?k[S]:S;M+=l(c[I][re],S)}I<c.length-1&&(!D||0<z&&!$)&&(M+=y)}}return M}function l(k,c){var D,M;return k==null?"":k.constructor===Date?JSON.stringify(k).slice(1,25):(M=!1,v&&typeof k=="string"&&v.test(k)&&(k="'"+k,M=!0),D=k.toString().replace(f,O),(M=M||r===!0||typeof r=="function"&&r(k,c)||Array.isArray(r)&&r[c]||((J,ee)=>{for(var C=0;C<ee.length;C++)if(-1<J.indexOf(ee[C]))return!0;return!1})(D,n.BAD_DELIMITERS)||-1<D.indexOf(s)||D.charAt(0)===" "||D.charAt(D.length-1)===" ")?q+D+q:D)}},n.RECORD_SEP="",n.UNIT_SEP="",n.BYTE_ORDER_MARK="\uFEFF",n.BAD_DELIMITERS=["\r",`
`,'"',n.BYTE_ORDER_MARK],n.WORKERS_SUPPORTED=!_&&!!i.Worker,n.NODE_STREAM_INPUT=1,n.LocalChunkSize=10485760,n.RemoteChunkSize=5242880,n.DefaultDelimiter=",",n.Parser=K,n.ParserHandle=G,n.NetworkStreamer=L,n.FileStreamer=b,n.StringStreamer=F,n.ReadableStreamStreamer=te,i.jQuery&&((u=i.jQuery).fn.parse=function(e){var t=e.config||{},r=[];return this.each(function(y){if(!(u(this).prop("tagName").toUpperCase()==="INPUT"&&u(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var q=0;q<this.files.length;q++)r.push({file:this.files[q],inputElem:this,instanceConfig:u.extend({},t)})}),a(),this;function a(){if(r.length===0)j(e.complete)&&e.complete();else{var y,q,O,T,d=r[0];if(j(e.before)){var v=e.before(d.file,d.inputElem);if(typeof v=="object"){if(v.action==="abort")return y="AbortError",q=d.file,O=d.inputElem,T=v.reason,void(j(e.error)&&e.error({name:y},q,O,T));if(v.action==="skip")return void s();typeof v.config=="object"&&(d.instanceConfig=u.extend(d.instanceConfig,v.config))}else if(v==="skip")return void s()}var f=d.instanceConfig.complete;d.instanceConfig.complete=function(H){j(f)&&f(H,d.file,d.inputElem),s()},n.parse(d.file,d.instanceConfig)}}function s(){r.splice(0,1),a()}}),h&&(i.onmessage=function(e){e=e.data,n.WORKER_ID===void 0&&e&&(n.WORKER_ID=e.workerId),typeof e.input=="string"?i.postMessage({workerId:n.WORKER_ID,results:n.parse(e.input,e.config),finished:!0}):(i.File&&e.input instanceof File||e.input instanceof Object)&&(e=n.parse(e.input,e.config))&&i.postMessage({workerId:n.WORKER_ID,results:e,finished:!0})}),(L.prototype=Object.create(E.prototype)).constructor=L,(b.prototype=Object.create(E.prototype)).constructor=b,(F.prototype=Object.create(F.prototype)).constructor=F,(te.prototype=Object.create(E.prototype)).constructor=te,n})})(be)),be.exports}var Ye=Xe();const Ie=Te(Ye);function Le(m){const g=(m||"").trim().toLowerCase();if(!g)return[];const w=g.replace(/[^a-z0-9]/g,""),i=g.replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,"");return Array.from(new Set([g,w,i].filter(Boolean)))}function Ge(m={}){const g={};for(const[w,i]of Object.entries(m)){const u=(i||"").toString().trim(),_=Le(w);for(const h of _)g[h]===void 0&&(g[h]=u)}return g}function _e(m=""){const g=m.trim();return g?g.charAt(0).toUpperCase()+g.slice(1).toLowerCase():""}function Ze(m={}){const g=(m.full_name||m.fullname||"").trim();if(g){const[A="",...R]=g.split(/\s+/),n=R.join(" "),E=_e(A),L=_e(n);return{first:E,last:L,name:[E,L].filter(Boolean).join(" ").trim()}}const w=m.first_name||m.firstname||"",i=m.last_name||m.lastname||"",u=_e(w),_=_e(i),h=_e(m.name||m.contact||"");return{first:u,last:_,name:[u,_].filter(Boolean).join(" ").trim()||h}}function et(m){return new Promise((g,w)=>{Ie.parse(m,{header:!0,skipEmptyLines:!0,transformHeader:i=>i.trim(),complete:i=>{var L;if(i.errors.length>0){const b=i.errors.find(F=>F.type==="Delimiter"||F.type==="Quotes");if(b)return w(new Error(`CSV parse error: ${b.message}`))}const u=i.data,_=((L=i.meta)==null?void 0:L.fields)||Object.keys(u[0]||{}),h=_.find(b=>Le(b).includes("lastcontacted")),A=_.find(b=>{const F=(b||"").trim().toLowerCase();return/^(e-?mail(address)?|mail)$/.test(F)});if(!A)return w(new Error('No "email" column found in CSV. Please include a column named "email" (or "mail", "emailaddress").'));let R=0,n=0;const E=u.map((b,F)=>{if(h?(b[h]||"").toString().trim():"")return n+=1,null;const G=(b[A]||"").trim();if(!G||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(G))return R+=1,null;const X=Ge(b),K=Ze(X),Z=K.name,Q={...Object.fromEntries(Object.entries(b).map(([ce,de])=>[ce,(de||"").toString().trim()])),...X};return Q.email=G,K.first&&(Q.first_name=K.first,Q.firstname=K.first),K.last&&(Q.last_name=K.last,Q.lastname=K.last),Z&&(Q.name=Z),Z&&(Q.full_name=Z,Q.fullname=Z),{email:G,name:Z,__rowIndex:F,...Q}}).filter(Boolean);g({recipients:E,totalRows:u.length,skipped:u.length-E.length,skippedInvalidEmail:R,skippedPreviouslyContacted:n,headers:_,rows:u,lastContactedKey:h})},error:i=>w(new Error(i.message))})})}function tt(m=[],g=[]){return Ie.unparse({fields:m,data:g.map(w=>m.map(i=>(w==null?void 0:w[i])??""))})}async function rt(m,g,w){try{return(await m.acquireTokenSilent({...w,account:g})).accessToken}catch{return(await m.acquireTokenPopup(w)).accessToken}}async function nt(m,g,w,i,u,_){var R;const h={subject:i,importance:"normal",body:{contentType:"HTML",content:u},toRecipients:[{emailAddress:{address:g,name:w||g}}],..._},A=await fetch("https://graph.microsoft.com/v1.0/me/sendMail",{method:"POST",headers:{Authorization:`Bearer ${m}`,"Content-Type":"application/json"},body:JSON.stringify({message:h,saveToSentItems:!0})});if(!A.ok){const n=await A.json().catch(()=>({})),E=((R=n==null?void 0:n.error)==null?void 0:R.message)||`HTTP ${A.status}`;throw new Error(E)}return!0}function st(){var s,y,q;const{instance:m,accounts:g}=De(),w=Ne(),i=g[0],[u,_]=ne.useState(null),[h,A]=ne.useState(null),[R,n]=ne.useState(""),[E,L]=ne.useState(""),[b,F]=ne.useState(0),[te,G]=ne.useState(!1),[X,K]=ne.useState([]),[Z,Q]=ne.useState(""),ce=((i==null?void 0:i.username)||"").toLowerCase().endsWith("@shakedefi.com"),de=async O=>{var d;const T=(d=O.target.files)==null?void 0:d[0];if(T){L("");try{const v=await Je(T);_(v),n(v.subject||"")}catch(v){L(`DOCX parse error: ${v.message}`)}}},se=async O=>{var d;const T=(d=O.target.files)==null?void 0:d[0];if(T){L("");try{const v=await et(T);A(v),F(0)}catch(v){L(`CSV parse error: ${v.message}`)}}},j=(s=h==null?void 0:h.recipients)==null?void 0:s[b],e=ne.useMemo(()=>u!=null&&u.html?xe(u.html,j||{}):"",[u,j]),t=ne.useMemo(()=>R?xe(R,j||{}):"",[R,j]),r=async()=>{var O;if(i){if(!ce){L("Please sign in with your @shakedefi.com Microsoft account.");return}if(!u||!((O=h==null?void 0:h.recipients)!=null&&O.length)){L("Upload both a .docx and a valid .csv file first.");return}if(!R.trim()){L("Email subject is required.");return}G(!0),L(""),K([]),Q("");try{const T=await rt(m,i,Re),d=(h.rows||[]).map(l=>({...l})),v=[...h.headers||[]],f=h.lastContactedKey||"Last Contacted";v.includes(f)||v.push(f);for(const l of h.recipients){const k=xe(u.html,l),c=xe(R,l);try{await nt(T,l.email,l.name||l.company||l.email,c,k);const D=l.__rowIndex;D!==void 0&&d[D]&&(d[D][f]=new Date().toISOString()),K(M=>[...M,{email:l.email,status:"sent"}])}catch(D){K(M=>[...M,{email:l.email,status:"failed",error:D.message}])}await new Promise(D=>setTimeout(D,350))}const H=tt(v,d);Q(H),A(l=>l&&{...l,rows:d,headers:v,lastContactedKey:f})}catch(T){L(`Unable to send emails: ${T.message}`)}finally{G(!1)}}},a=()=>{if(!Z)return;const O=new Blob([Z],{type:"text/csv;charset=utf-8;"}),T=URL.createObjectURL(O),d=document.createElement("a");d.href=T,d.download=`recipients-updated-${new Date().toISOString().replace(/[:.]/g,"-")}.csv`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(T)};return o.jsx("main",{className:"mailer-shell",children:o.jsxs("section",{className:"mailer-panel",children:[o.jsx("h1",{children:"ShakeDefi Marketing"}),w?o.jsxs("div",{className:"workflow",children:[o.jsxs("div",{className:"signed-in-row",children:[o.jsxs("p",{className:"signed-in-text",children:["Signed in as ",o.jsx("strong",{children:i==null?void 0:i.username})]}),o.jsx("button",{className:"signin-btn",onClick:()=>m.logoutPopup({postLogoutRedirectUri:window.location.origin}),children:"Sign Out"})]}),!ce&&o.jsx("p",{className:"error-text",children:"Please use a @shakedefi.com account to send campaigns."}),o.jsxs("div",{className:"help-box",children:[o.jsx("h2",{children:"Preparing your files"}),o.jsxs("ul",{children:[o.jsxs("li",{children:["DOCX: first line can be ",o.jsx("code",{children:"Subject: Your email subject"})]}),o.jsx("li",{children:"DOCX: or first H1 heading becomes the subject"}),o.jsxs("li",{children:["Body supports variables like ",o.jsx("code",{children:"{{name}}"}),", ",o.jsx("code",{children:"{{company}}"}),", ",o.jsx("code",{children:"{{customfield}}"})]}),o.jsxs("li",{children:["CSV requires ",o.jsx("code",{children:"email"})," (or ",o.jsx("code",{children:"mail"})," / ",o.jsx("code",{children:"emailaddress"}),")"]}),o.jsxs("li",{children:["Optional columns: ",o.jsx("code",{children:"name"}),", ",o.jsx("code",{children:"company"}),", and any template variables"]})]})]}),o.jsxs("div",{className:"upload-grid",children:[o.jsxs("label",{className:"upload-card",children:[o.jsx("span",{children:"Upload .docx email body"}),o.jsx("input",{type:"file",accept:".docx",onChange:de})]}),o.jsxs("label",{className:"upload-card",children:[o.jsx("span",{children:"Upload .csv recipients"}),o.jsx("input",{type:"file",accept:".csv",onChange:se})]})]}),(u||h)&&o.jsxs("div",{className:"status-row",children:[o.jsx("span",{children:u?"✅ DOCX loaded":"⬜ DOCX not loaded"}),o.jsx("span",{children:h?`✅ ${h.recipients.length} valid recipients${h.skipped?` (${h.skipped} skipped)`:""}`:"⬜ CSV not loaded"})]}),o.jsxs("label",{className:"subject-field",children:["Subject",o.jsx("input",{value:R,onChange:O=>n(O.target.value),placeholder:"Your email subject"})]}),((y=h==null?void 0:h.recipients)==null?void 0:y.length)>0&&o.jsxs("div",{className:"preview-wrap",children:[o.jsxs("div",{className:"recipient-list",children:[o.jsx("h3",{children:"Recipients"}),h.recipients.map((O,T)=>o.jsx("button",{className:T===b?"recipient-btn active":"recipient-btn",onClick:()=>F(T),children:O.email},`${O.email}-${T}`))]}),o.jsxs("div",{className:"preview-panel",children:[o.jsx("h3",{children:"Personalized Preview"}),o.jsxs("p",{children:[o.jsx("strong",{children:"To:"})," ",(j==null?void 0:j.email)||"—"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Subject:"})," ",t||"—"]}),o.jsx("div",{className:"email-html",dangerouslySetInnerHTML:{__html:e}})]})]}),o.jsx("button",{className:"send-btn",disabled:te||!ce||!u||!((q=h==null?void 0:h.recipients)!=null&&q.length)||!R.trim(),onClick:r,children:te?"Sending…":"Send All Emails"}),E&&o.jsx("p",{className:"error-text",children:E}),X.length>0&&o.jsxs("div",{className:"results",children:[o.jsx("h3",{children:"Send Results"}),o.jsx("ul",{children:X.map((O,T)=>o.jsxs("li",{children:[O.status==="sent"?"✅":"❌"," ",O.email,O.error?` — ${O.error}`:""]},`${O.email}-${T}`))}),Z&&o.jsx("button",{className:"send-btn",onClick:a,children:"Download Updated CSV"})]})]}):o.jsxs("div",{children:[o.jsx("p",{className:"signed-in-text",children:"Sign in with your @shakedefi.com Microsoft account to begin."}),o.jsx("button",{className:"signin-btn",onClick:()=>m.loginPopup(Re),children:"Microsoft Exchange Sign In"})]})]})})}const it=new Pe(He);Be.createRoot(document.getElementById("root")).render(o.jsx(ne.StrictMode,{children:o.jsx(Me,{instance:it,children:o.jsx(st,{})})}));
